{
    "statements": [
        {
            "query": "MATCH (cluster:GKECluster{exposed_internet:true})<-[:RESOURCE]-(:GCPProject{id: $GCP_PROJECT_ID})<-[:OWNER]-(:CloudanixWorkspace{id: $WORKSPACE_ID}) WITH cluster LIMIT $LIMIT_SIZE REMOVE cluster.exposed_internet, cluster.exposed_internet_type return COUNT(*) as TotalCompleted",
            "iterative": true,
            "iterationsize": 1000
        },
        {
            "query": "MATCH (cluster:GKECluster)<-[:RESOURCE]-(:GCPProject{id: $GCP_PROJECT_ID})<-[:OWNER]-(:CloudanixWorkspace{id: $WORKSPACE_ID}) \nWHERE cluster.master_authorized_networks IS NULL \nSET cluster.exposed_internet = true, cluster.exposed_internet_type = coalesce(cluster.exposed_internet_type, []) + 'no_master_authorized_networks'",
            "iterative": false
        }
    ],
    "name": "GCP Storage Bucket public policy exposure analysis"
}
