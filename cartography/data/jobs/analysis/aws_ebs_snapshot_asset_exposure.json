{
	"statements": [
		{
			"query": "MATCH (snapshot:EBSSnapshot)<-[:RESOURCE]-(:AWSAccount{id: $AWS_ID})<-[:OWNER]-(:CloudanixWorkspace{id: $WORKSPACE_ID}) WHERE EXISTS(snapshot.exposed_internet) WITH snapshot LIMIT $LIMIT_SIZE REMOVE snapshot.exposed_internet, snapshot.exposed_internet_type return COUNT(*) as TotalCompleted",
			"iterative": true,
			"iterationsize": 100
		},
		{
			"query": "MATCH (snapshot:EBSSnapshot)<-[:RESOURCE]-(:AWSAccount{id: $AWS_ID})<-[:OWNER]-(:CloudanixWorkspace{id: $WORKSPACE_ID}) WHERE 'all' in snapshot.volume_permissions SET snapshot.exposed_internet = true ,(CASE WHEN NOT 'endpoint_type' IN coalesce(snapshot.exposed_internet_type , []) THEN snapshot END).exposed_internet_type = coalesce(snapshot.exposed_internet_type , []) + 'ebs_volume_permissions_group';",
            "iterative": false
		}
	],
	"name": "aws ebs snapshot asset internet exposure"
}
