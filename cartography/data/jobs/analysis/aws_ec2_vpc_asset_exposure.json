{
    "statements": [
        {
            "query": "MATCH ((n:AWSVpc)<-[:RESOURCE]-(:AWSAccount{id: $AWS_ID})<-[:OWNER]-(:CloudanixWorkspace{id: $WORKSPACE_ID})) where EXISTS(n.exposed_internet) WITH n LIMIT $LIMIT_SIZE REMOVE n.exposed_internet, n.exposed_internet_type return COUNT(*) as TotalCompleted",
            "iterative": true,
            "iterationsize": 100
        },
        {
            "query": "MATCH (:AWSInternetGateway)-[:ATTACHED_TO]->(vpc:AWSVpc)<-[:RESOURCE]-(:AWSAccount{id: $AWS_ID})<-[:OWNER]-(:CloudanixWorkspace{id: $WORKSPACE_ID}) SET vpc.exposed_internet = true,(CASE WHEN NOT 'public_vpc' IN coalesce(vpc.exposed_internet_type, []) THEN vpc END).exposed_internet_type = coalesce(vpc.exposed_internet_type, []) + 'public_vpc';",
            "iterative": false
        }
    ],
    "name": "aws vpc internet exposure"
}