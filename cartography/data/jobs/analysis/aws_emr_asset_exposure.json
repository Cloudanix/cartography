{
	"statements": [
		{
			"query": "MATCH (emr:EMRCluster)<-[:RESOURCE]-(:AWSAccount{id: $AWS_ID})<-[:OWNER]-(:CloudanixWorkspace{id: $WORKSPACE_ID}) WHERE EXISTS(emr.exposed_internet) WITH emr LIMIT $LIMIT_SIZE REMOVE emr.exposed_internet, emr.exposed_internet_type return COUNT(*) as TotalCompleted",
			"iterative": true,
			"iterationsize": 100
		},
		{
			"query": "MATCH (emr:EMRCluster{public_access_configuration: false})<-[:RESOURCE]-(:AWSAccount{id: $AWS_ID})<-[:OWNER]-(:CloudanixWorkspace{id: $WORKSPACE_ID}) SET emr.anonymous_access = true, (CASE WHEN NOT 'assign_public_ip' IN  coalesce(emr.anonymous_access_type , []) THEN emr END).anonymous_access_type = coalesce(emr.anonymous_access_type , []) + 'assign_public_ip';",
			"iterative": false
		}
	],
	"name": "aws EMR asset internet exposure"
}
