{
	"statements": [
		{
			"query": "MATCH (bucket:S3Bucket)<-[:RESOURCE]-(aws:AWSAccount{id: $AWS_ID})<-[:OWNER]-(:CloudanixWorkspace{id: $WORKSPACE_ID}) WHERE EXISTS(bucket.exposed_internet) WITH bucket LIMIT $LIMIT_SIZE REMOVE bucket.exposed_internet, bucket.exposed_internet_type return COUNT(*) as TotalCompleted",
			"iterative": false
		},
		{
			"query": "MATCH (bucket:S3Bucket{is_public: true})<-[:RESOURCE]-(aws:AWSAccount{id: $AWS_ID})<-[:OWNER]-(:CloudanixWorkspace{id: $WORKSPACE_ID}) WITH bucket WHERE (NOT EXISTS(bucket.exposed_internet_type)) OR (NOT 'policy' IN bucket.exposed_internet_type) SET bucket.exposed_internet = true, bucket.exposed_internet_type = coalesce(bucket.exposed_internet_type , []) + 'policy';",
			"iterative": false
		}
	],
	"name": "AWS S3 policies public exposure"
}
