{
	"statements": [
		{
			"query": "MATCH (bucket:S3Bucket)<-[:RESOURCE]-(aws:AWSAccount{id: $AWS_ID}) WHERE EXISTS(bucket.exposed_internet) WITH bucket LIMIT $LIMIT_SIZE REMOVE bucket.exposed_internet return COUNT(*) as TotalCompleted",
			"iterative": false
		},
		{
			"query": "MATCH (bucket:S3Bucket{is_public: true})<-[:RESOURCE]-(aws:AWSAccount{id: $AWS_ID}) WITH bucket SET bucket.exposed_internet = true",
			"iterative": false
		}
	],
	"name": "AWS S3 public exposure"
}
